{"remainingRequest":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/src/components/ol_map_page.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/src/components/ol_map_page.vue","mtime":1682363936932},{"path":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1682361370579},{"path":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/node_modules/babel-loader/lib/index.js","mtime":1682361371663},{"path":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1682361370579},{"path":"/Users/danramage/Documents/workspace/WaterQuality/RiverWQFrontEnd/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1682361372188}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAndnVlJwppbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAubWluLmNzcycKaW1wb3J0ICdib290c3RyYXAtdnVlL2Rpc3QvYm9vdHN0cmFwLXZ1ZS5jc3MnCmltcG9ydCAndHlwZWZhY2UtbW9udHNlcnJhdC9pbmRleC5jc3MnCgppbXBvcnQgeyBNYXAsIFRpbGVMYXllciwgT3NtU291cmNlLCBHZW9sb2MsIFZlY3RvckxheWVyLCBWZWN0b3JTb3VyY2UsIFh5elNvdXJjZSwgU3R5bGVCb3gsIENpcmNsZVN0eWxlLCBGaWxsU3R5bGUsCiAgICBTdHJva2VTdHlsZSwgT3ZlcmxheSwgU2VsZWN0SW50ZXJhY3Rpb24sIFN0eWxlRnVuYyB9IGZyb20gJ3Z1ZWxheWVycycKVnVlLnVzZShNYXApOwpWdWUudXNlKFRpbGVMYXllcik7ClZ1ZS51c2UoT3NtU291cmNlKTsKVnVlLnVzZShHZW9sb2MpOwpWdWUudXNlKFZlY3RvckxheWVyKTsKVnVlLnVzZShWZWN0b3JTb3VyY2UpOwpWdWUudXNlKFh5elNvdXJjZSk7ClZ1ZS51c2UoU3R5bGVCb3gpOwpWdWUudXNlKEZpbGxTdHlsZSk7ClZ1ZS51c2UoU3Ryb2tlU3R5bGUpOwpWdWUudXNlKENpcmNsZVN0eWxlKTsKVnVlLnVzZShPdmVybGF5KTsKVnVlLnVzZShTZWxlY3RJbnRlcmFjdGlvbik7ClZ1ZS51c2UoU3R5bGVGdW5jKTsKCgppbXBvcnQgJ3Z1ZWxheWVycy9saWIvc3R5bGUuY3NzJyAvLyBuZWVkcyBjc3MtbG9hZGVyCgppbXBvcnQgeyBTaWRlYmFyUGx1Z2luLCBCdXR0b25QbHVnaW4sIEJ1dHRvbkdyb3VwUGx1Z2luLCBMYXlvdXRQbHVnaW4gfSBmcm9tICdib290c3RyYXAtdnVlJzsKVnVlLnVzZShCdXR0b25QbHVnaW4pOwpWdWUudXNlKEJ1dHRvbkdyb3VwUGx1Z2luKTsKVnVlLnVzZShMYXlvdXRQbHVnaW4pOwpWdWUudXNlKFNpZGViYXJQbHVnaW4pOwoKaW1wb3J0IERhdGFBUEkgZnJvbSAiLi4vdXRpbGl0aWVzL3Jlc3RfYXBpIjsKaW1wb3J0IEZlYXR1cmVVdGlscyBmcm9tICIuLi91dGlsaXRpZXMvZmVhdHVyZV9mdW5jcyI7CmltcG9ydCB7ZmluZFBvaW50T25TdXJmYWNlfSBmcm9tICd2dWVsYXllcnMvbGliL29sLWV4dCcKaW1wb3J0IEV2ZW50VXRpbHMgZnJvbSAiLi4vdXRpbGl0aWVzL2FuYWx5dGljc19mdW5jcyI7CgppbXBvcnQgSWNvbnNMZWdlbmQgZnJvbSAiQC9jb21wb25lbnRzL2ljb25zX2xlZ2VuZCI7CgppbXBvcnQgU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUnOwppbXBvcnQgSWNvbiBmcm9tICdvbC9zdHlsZS9JY29uJzsKCi8vU0luY2UgdGhlc2UgYXJlIG5vdCBpbiB0aGUgdGVtcGxhdGUsIHdlIGltcG9ydCB0aGVtIGhlcmUuIFdlIHVzZSB0aGVtIGluIHRoZSBqYXZhc2NyaXB0IGJlbG93IHdoZW4KLy9kZXRlcm1pbmluZyB3aGljaCBpY29uIHRvIHVzZS4KaW1wb3J0IExvd01hcmtlckljb24gZnJvbSAnQC9hc3NldHMvaW1hZ2VzL2xvd19tYXJrZXJfMjV4MjUucG5nJwppbXBvcnQgSGlNYXJrZXJJY29uIGZyb20gJ0AvYXNzZXRzL2ltYWdlcy9oaWdoX21hcmtlcl8yNXgyNS5wbmcnCmltcG9ydCBOb25lTWFya2VySWNvbiBmcm9tICdAL2Fzc2V0cy9pbWFnZXMvbm9uZV9tYXJrZXJfMjV4MjUucG5nJwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ09MTWFwUGFnZScsCgogICAgY29tcG9uZW50czogewogICAgICBJY29uc0xlZ2VuZAogICAgfSwKICAgIGRhdGEgKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRpdGxlOiAiSE9XJ1MgVEhFIEJFQUNIIiwKICAgICAgICAgICAgc2l0ZV9uYW1lOiAiIiwKICAgICAgICAgICAgem9vbTogNSwKICAgICAgICAgICAgY2VudGVyOiBbMCwwXSwKICAgICAgICAgICAgcm90YXRpb246IDAsCiAgICAgICAgICAgIGZlYXR1cmVzOiBbXSwKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgIGN1cnJlbnRfZ29vZ2xlX2xheWVyOiAncycsCiAgICAgICAgICAgIGN1cnJlbnRfbGF5ZXJfdXJsOiAnJywKICAgICAgICAgICAgY3VycmVudF9sYXllcl9uYW1lOiAiU2F0ZWxsaXRlIiwKICAgICAgICAgICAgeHl6X2xheWVyX3Zpc2libGU6IHRydWUsCiAgICAgICAgICAgIG9zbV9sYXllcl92aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgc2VsZWN0ZWRGZWF0dXJlczogW10sCiAgICAgICAgICAgIGFkdmlzb3J5X2xpbWl0czogdW5kZWZpbmVkLAogICAgICAgICAgICBub3djYXN0QWN0aXZlOiB0cnVlLAogICAgICAgICAgICBhZHZpc29yeUFjdGl2ZTogZmFsc2UsCiAgICAgICAgICAgIHNpZGViYXJBY3RpdmU6IGZhbHNlLAogICAgICAgICAgICBzaWRlYmFyQnRuQWN0aXZlOiBmYWxzZSwKICAgICAgICAgICAgY3Vyck1xTmR4OiB1bmRlZmluZWQsCiAgICAgICAgICAgIG1xU2VsZWN0b3JzOiB1bmRlZmluZWQsCiAgICAgICAgICAgIGxlZ2VuZF9pY29uczogW10sCiAgICAgICAgICAgIGZlYXR1cmVzX3N0eWxlZDogMAogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewoKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5yZXNpemVIYW5kbGVyKTsKICAgIH0sCiAgICBtb3VudGVkICgpIHsKICAgICAgICBsZXQgdm0gPSB0aGlzOwogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgdGhpcy5mZWF0dXJlc19zdHlsZWQgPSAwOwoKICAgICAgICB0aGlzLm1xU2VsZWN0b3JzID0gWwogICAgICAgICAgICB0aGlzLiRyZWZzLnZpc2libGVfeHMsCiAgICAgICAgICAgIHRoaXMuJHJlZnMudmlzaWJsZV9zbSwKICAgICAgICAgICAgdGhpcy4kcmVmcy52aXNpYmxlX21kLAogICAgICAgICAgICB0aGlzLiRyZWZzLnZpc2libGVfbGcsCiAgICAgICAgICAgIHRoaXMuJHJlZnMudmlzaWJsZV94bGcKICAgICAgICBdOwoKCiAgICAgICAgdGhpcy5jdXJyZW50X2xheWVyX3VybCA9IGBodHRwczovL210MC5nb29nbGUuY29tL3Z0L2x5cnM9JHt0aGlzLmN1cnJlbnRfZ29vZ2xlX2xheWVyfSZobD1lbiZ4PXt4fSZ5PXt5fSZ6PXt6fWA7CiAgICAgICAgbGV0IHBhdGggPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgaWYgKHBhdGgubGVuZ3RoKSB7CiAgICAgICAgICAgIGxldCBsb2NhdGlvbl9zaXRlX25hbWUgPSB0aGlzLiRzdG9yZS5zdGF0ZS5zaXRlX25hbWU7CiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoIlJldHJpZXZpbmcgaW5pdGlhbCBzaXRlOiAiICsgIGxvY2F0aW9uX3NpdGVfbmFtZSArICIgZGF0YS4iKTsKICAgICAgICAgICAgRGF0YUFQSS5HZXRTaXRlc1Byb21pc2UobG9jYXRpb25fc2l0ZV9uYW1lLCAnJywgdHJ1ZSwgdHJ1ZSkudGhlbihmZWF0dXJlcyA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCJSZXRyaWV2ZWQ6ICIgKyBmZWF0dXJlcy5kYXRhLnNpdGVzLmZlYXR1cmVzLmxlbmd0aCArICIgZmVhdHVyZXMiKTsKICAgICAgICAgICAgICAgIHZtLmZlYXR1cmVzID0gZmVhdHVyZXMuZGF0YS5zaXRlcy5mZWF0dXJlczsKICAgICAgICAgICAgICAgIGlmKCdsaW1pdHMnIGluIGZlYXR1cmVzLmRhdGEuYWR2aXNvcnlfaW5mbykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgndXBkYXRlQWR2aXNvcnlMaW1pdHMnLCBmZWF0dXJlcy5kYXRhLmFkdmlzb3J5X2luZm8ubGltaXRzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuc2l0ZV9uYW1lID0gZmVhdHVyZXMuZGF0YS5wcm9qZWN0X2FyZWEubmFtZTsKCiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gIGZhbHNlOwoKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgaWYodm0uJHJlZnMuc2l0ZV92ZWN0b3JfbGF5ZXIuJHNvdXJjZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdm0uJHJlZnMuc2l0ZV9tYXAuJG1hcC51cGRhdGVTaXplKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnNpdGVzTGF5ZXJFeHRlbnRzID0gdm0uJHJlZnMuc2l0ZV92ZWN0b3JfbGF5ZXIuJHNvdXJjZS5nZXRFeHRlbnQodm0uc2l0ZXNMYXllckV4dGVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbV9zaXplID0gdm0uJHJlZnMuc2l0ZV9tYXAuJG1hcC5nZXRTaXplKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZtLiRyZWZzLnNpdGVfbWFwLmdldFZpZXcoKS5maXQodm0uc2l0ZXNMYXllckV4dGVudHMsIG1fc2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vdm0uJHJlZnMuc2l0ZV9tYXAuJG1hcC5yZWRyYXcoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgIHZtLiRuZXh0VGljayhmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCJuZXh0VGljayBtb3VudGVkIHNldHRpbmcgbWFwIGV4dGVudC4iKTsKICAgICAgICAgICAgICAgIH0pOyovCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCBlcnJvcl9tZXNzYWdlID0gJyc7CiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXR1c19jb2RlID0gNDA0OwogICAgICAgICAgICAgICAgICAgIGlmKCdyZXNwb25zZScgaW4gZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfY29kZSA9IGVycm9yLnJlc3BvbnNlLnN0YXR1czsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdlcnJvcicgaW4gZXJyb3IucmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdtZXNzYWdlJyBpbiBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfbWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IubWVzc2FnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX21lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlN0YXR1cyBjb2RlOiAiICsgc3RhdHVzX2NvZGUgKyIuIEVycm9yIE1zZzogIiArIGVycm9yX21lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfbWVzc2FnZSA9IGVycm9yOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICc0MDQnLAogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX21lc3NhZ2U6IGVycm9yX21lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfY29kZTogc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgIH0KICAgIH0sCiAgICBkZXN0cm95ZWQoKSB7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHRoaXMucmVzaXplSGFuZGxlcik7CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIHJlc2l6ZUhhbmRsZXIoKSB7CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubXFTZWxlY3RvcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmKHRoaXMubXFTZWxlY3RvcnNbaV0ub2Zmc2V0TGVmdCA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3Vyck1xSWR4ICE9IGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyTXFJZHggPSBpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYodGhpcy5jdXJyTXFJZHggPCAzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aGlzLnNpZGViYXJBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIHBvaW50T25TdXJmYWNlOiBmaW5kUG9pbnRPblN1cmZhY2UsCiAgICAgICAgc2l0ZVN0eWxlRmFjdG9yeSgpIHsKICAgICAgICAgICAgY29uc29sZS5kZWJ1Zygic2l0ZVN0eWxlRmFjdG9yeSBzdGFydGVkIik7CiAgICAgICAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgICAgICAgIC8qCiAgICAgICAgICAgIEZvciBlYWNoIGZlYXR1cmUsIHRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBkZXRlcm1pbmUgd2hhdCBpY29uIHRvIHVzZSBiYXNlZCBvbiB0aGUgbGV2ZWwuCiAgICAgICAgICAgICovCiAgICAgICAgICAgIHZhciBzaXRlU3R5bGVGdW5jdGlvbiA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pIHsKICAgICAgICAgICAgICAgIHJlc29sdXRpb247CiAgICAgICAgICAgICAgICBpZih2bS5mZWF0dXJlc19zdHlsZWQgPCB2bS5mZWF0dXJlcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB2bS5mZWF0dXJlc19zdHlsZWQgKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBpY29uX3NjYWxlID0gMC43NTsKICAgICAgICAgICAgICAgIGxldCBwcm9wZXJ0aWVzID0gZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgICAgICAgICBsZXQgc2l0ZV90eXBlID0gcHJvcGVydGllcy5zaXRlX3R5cGU7CiAgICAgICAgICAgICAgICBsZXQgaWNvbiA9IG5ldyBJY29uKHsKICAgICAgICAgICAgICAgICAgICBzcmM6IE5vbmVNYXJrZXJJY29uLAogICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmKHNpdGVfdHlwZSA9PSAnV2F0ZXIgUXVhbGl0eScpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodm0uYWR2aXNvcnlBY3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2Fkdmlzb3J5JyBpbiBwcm9wZXJ0aWVzW3NpdGVfdHlwZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRhRnJlc2ggPSBGZWF0dXJlVXRpbHMuaXNEYXRhRnJlc2gocHJvcGVydGllc1tzaXRlX3R5cGVdLmFkdmlzb3J5KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhRnJlc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gcHJvcGVydGllc1tzaXRlX3R5cGVdLmFkdmlzb3J5LnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGlfbGltaXQgPSB2bS4kc3RvcmUuc3RhdGUuYWR2aXNvcnlfbGltaXRzLmhpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbG9fbGltaXQgPSB2bS4kc3RvcmUuc3RhdGUuYWR2aXNvcnlfbGltaXRzLmxvdzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID49IGhpX2xpbWl0Lm1pbmltdW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUuZGVidWcoIkZlYXR1cmU6ICIgKyBmZWF0dXJlLmdldElkKCkgKyAiIEhpIHN0eWxlIHZhbHVlOiAiICsgdmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IEhpTWFya2VySWNvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCBsb19saW1pdC5tYXhpbXVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCJGZWF0dXJlOiAiICsgZmVhdHVyZS5nZXRJZCgpICsgIiBMb3cgc3R5bGUgdmFsdWU6ICIgKyB2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbiA9IG5ldyBJY29uKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogTG93TWFya2VySWNvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygiRmVhdHVyZTogIiArIGZlYXR1cmUuZ2V0SWQoKSArICIgTm8gYWR2aXNvcnkgZGF0YSBmb3VuZC4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbiA9IG5ldyBJY29uKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogTm9uZU1hcmtlckljb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTogaWNvbl9zY2FsZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnbm93Y2FzdHMnIGluIHByb3BlcnRpZXNbc2l0ZV90eXBlXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxldmVsID0gcHJvcGVydGllc1tzaXRlX3R5cGVdLm5vd2Nhc3RzLmxldmVsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxldmVsID09ICdMT1cnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBMb3dNYXJrZXJJY29uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnSElHSCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbiA9IG5ldyBJY29uKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IEhpTWFya2VySWNvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTogaWNvbl9zY2FsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgaWNvbiA9IG5ldyBJY29uKHsKICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBOb25lTWFya2VySWNvbiwKICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6IGljb25fc2NhbGUKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoISh2bS5sZWdlbmRfaWNvbnMuaW5jbHVkZXMoJ1dhdGVyIFF1YWxpdHknKSkpIHsKICAgICAgICAgICAgICAgICAgICAgIHZtLmxlZ2VuZF9pY29ucy5wdXNoKCJXYXRlciBRdWFsaXR5Iik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihzaXRlX3R5cGUgPT0gJ1NoZWxsZmlzaCcpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2l0ZV90eXBlIGluIHByb3BlcnRpZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcnN0IGNoZWNrIHRvIHNlZSBpZiBvdXIgZGF0YSBpcyBzdGlsbCBmcmVzaC4KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YUZyZXNoID0gRmVhdHVyZVV0aWxzLmlzRGF0YUZyZXNoKHByb3BlcnRpZXNbc2l0ZV90eXBlXS5hZHZpc29yeSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFGcmVzaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TaGVsbGZpc2ggdmFsdWVzIGFyZSBlaXRoZXIgdHJ1ZSBmb3IgY2xvc2VkIG9yIGZhbHNlIGZvciBvcGVuLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gcHJvcGVydGllc1tzaXRlX3R5cGVdLmFkdmlzb3J5LnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uID0gbmV3IEljb24oewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogU2hlbGxmaXNoTG93TWFya2VySWNvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTogaWNvbl9zY2FsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBTaGVsbGZpc2hIaU1hcmtlckljb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6IGljb25fc2NhbGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogU2hlbGxmaXNoTm9uZU1hcmtlckljb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpY29uID0gbmV3IEljb24oewogICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogU2hlbGxmaXNoTm9uZU1hcmtlckljb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6IGljb25fc2NhbGUKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoISh2bS5sZWdlbmRfaWNvbnMuaW5jbHVkZXMoJ1NoZWxsZmlzaCcpKSkgewogICAgICAgICAgICAgICAgICAgICAgdm0ubGVnZW5kX2ljb25zLnB1c2goIlNoZWxsZmlzaCIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoc2l0ZV90eXBlID09ICdDYW1lcmEgU2l0ZScpIHsKICAgICAgICAgICAgICAgICAgICBpY29uID0gbmV3IEljb24oewogICAgICAgICAgICAgICAgICAgICAgICBzcmM6IENhbWVyYUljb24sCiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uX3NjYWxlCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYoISh2bS5sZWdlbmRfaWNvbnMuaW5jbHVkZXMoJ0NhbWVyYSBTaXRlJykpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmxlZ2VuZF9pY29ucy5wdXNoKCdDYW1lcmEgU2l0ZScpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZWxzZSBpZihzaXRlX3R5cGUgPT0gJ0JlYWNoIEFtYmFzc2Fkb3InKSB7CiAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgc3JjOiBNb3RlTWFyaW5lQmVhY2hBbWJhc3NhZG9ySWNvbiwKICAgICAgICAgICAgICAgICAgICAvL1NjYWxlIHRoZSBpY29uIGEgYml0IHRvIG1ha2UgaXQgbGVzcyBvdmVyd2hlbG1pbmcgb24gdGhlIG1hcC4KICAgICAgICAgICAgICAgICAgICBzY2FsZTogMC44CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBpZighKHZtLmxlZ2VuZF9pY29ucy5pbmNsdWRlcygnQmVhY2ggQW1iYXNzYWRvcicpKSkgewogICAgICAgICAgICAgICAgICAgIHZtLmxlZ2VuZF9pY29ucy5wdXNoKCdCZWFjaCBBbWJhc3NhZG9yJyk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZWxzZSBpZihzaXRlX3R5cGUgPT0gJ1NoZWxsY2FzdCcpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGljb24gPSBuZXcgSWNvbih7CiAgICAgICAgICAgICAgICAgICAgc3JjOiBTaGVsbGNhc3RJY29uLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgaWYoISh2bS5sZWdlbmRfaWNvbnMuaW5jbHVkZXMoJ1NoZWxsY2FzdCcpKSkgewogICAgICAgICAgICAgICAgICAgIHZtLmxlZ2VuZF9pY29ucy5wdXNoKCdTaGVsbGNhc3QnKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbGV0IGljb25fc3R5bGUgPSBbCiAgICAgICAgICAgICAgICAgICAgbmV3IFN0eWxlKHsKICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGljb24sCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICByZXR1cm4oaWNvbl9zdHlsZSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiBzaXRlU3R5bGVGdW5jdGlvbjsKICAgICAgICB9LAogICAgICAgIGRhdGFUeXBlQ2xpY2soZGF0YV90eXBlKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoIkRhdGEgVHlwZSBCdXR0b24gY2xpY2tlZDogIiArIGRhdGFfdHlwZSk7CiAgICAgICAgICAgIGlmKGRhdGFfdHlwZSA9PSAnbm93Y2FzdCcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRoaXMubm93Y2FzdEFjdGl2ZSA9IHRydWU7CiAgICAgICAgICAgICAgICB0aGlzLmFkdmlzb3J5QWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnNpdGVfdmVjdG9yX2xheWVyLiRzb3VyY2UuY2hhbmdlZCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICB0aGlzLm5vd2Nhc3RBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuYWR2aXNvcnlBY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5zaXRlX3ZlY3Rvcl9sYXllci4kc291cmNlLmNoYW5nZWQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2lkZWJhckJ1dHRvbkNsaWNrKCkgewogICAgICAgICAgICB0aGlzLnNpZGViYXJBY3RpdmUgPSAhdGhpcy5zaWRlYmFyQWN0aXZlOwogICAgICAgICAgICB0aGlzLnNpZGViYXJCdG5BY3RpdmUgPSAhdGhpcy5zaWRlYmFyQnRuQWN0aXZlOwogICAgICAgICAgICBjb25zb2xlLmRlYnVnKCJzaWRlYmFyQnV0dG9uQ2xpY2sgY2xpY2tlZDogIiArIHRoaXMuc2lkZWJhckFjdGl2ZSk7CiAgICAgICAgfSwKICAgICAgICBsYXllclNlbGVjdGVkKGV2ZW50LCBsYXllcl90eXBlLCBsYXllcl9zZWxlY3RlZCkgewogICAgICAgICAgICAvL1NldCB0aGUgbmFtZSBvZiB0aGUgY3VycmVudCBsYXllciBzZWxlY3RlZCBpbiBkcm9wZG93bi4KICAgICAgICAgICAgdGhpcy5jdXJyZW50X2xheWVyX25hbWUgPSBldmVudC50YXJnZXQudGV4dDsKICAgICAgICAgICAgdGhpcy5vc21fbGF5ZXJfdmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnh5el9sYXllcl92aXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIGlmKGxheWVyX3R5cGUgPT09ICdnb29nbGUnKSB7CiAgICAgICAgICAgICAgICB0aGlzLnh5el9sYXllcl92aXNpYmxlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8vQnVpbGQgdGhlIFVSTCBmb3IgdGhlIFhZWiBnb29nbGUgbGF5ZXIuCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfZ29vZ2xlX2xheWVyID0gbGF5ZXJfc2VsZWN0ZWQ7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfbGF5ZXJfdXJsID0gYGh0dHBzOi8vbXQwLmdvb2dsZS5jb20vdnQvbHlycz0ke3RoaXMuY3VycmVudF9nb29nbGVfbGF5ZXJ9JmhsPWVuJng9e3h9Jnk9e3l9Jno9e3p9YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKGxheWVyX3R5cGUgPT0gJ29wZW5zdHJlZXRtYXAnKSB7CiAgICAgICAgICAgICAgICB0aGlzLm9zbV9sYXllcl92aXNpYmxlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgLyoKICAgICAgICBUaGlzIGFsbG93cyB1cyB0byBkeW5hbWljYWxseSBjaG9vc2UgdGhlIHBvcHVwIHRvIHVzZSBiYXNlZCBvbiB0aGUgc2l0ZV90eXBlIGZpZWxkLgogICAgICAgICovCiAgICAgICAgZ2V0UG9wdXBDb21wb25lbnQoZmVhdHVyZSkgewogICAgICAgICAgICAvKlRyYWNrIHRoZSBjbGljayBldmVudCovCiAgICAgICAgICAgIC8qdGhpcy4kZ2EuZXZlbnQoewogICAgICAgICAgICAgICAgZXZlbnRDYXRlZ29yeTogJ1NhbXBsZVNpdGVDbGljaycsCiAgICAgICAgICAgICAgICBldmVudEFjdGlvbjogJ2NsaWNrJywKICAgICAgICAgICAgICAgIGV2ZW50TGFiZWw6IGZlYXR1cmUucHJvcGVydGllcy5kZXNjcmlwdGlvbgogICAgICAgICAgICB9KTsqLwoKICAgICAgICAgICAgaWYoZmVhdHVyZS5wcm9wZXJ0aWVzLnNpdGVfdHlwZSA9PSAiV2F0ZXIgUXVhbGl0eSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGxldCBuYW1lID0gJ1N0YXRpb25QYWdlJzsKICAgICAgICAgICAgICAgIEV2ZW50VXRpbHMubG9nX2V2ZW50KHRoaXMuJGd0YWcsICdjbGljaycsICdXUSBTdGF0aW9uJywgZmVhdHVyZS5wcm9wZXJ0aWVzLmRlc2NyaXB0aW9uLCAwKTsKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgc2l0ZV9uYW1lOiBmZWF0dXJlLnByb3BlcnRpZXMuZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgc2l0ZV9pZDogZmVhdHVyZS5pZCwKICAgICAgICAgICAgICAgICAgICBncmFwaF9kYXRhOiB0aGlzLmdyYXBoX2RhdGEKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIC8vcmV0dXJuKFdRUG9wdXApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlbHNlIGlmKGZlYXR1cmUucHJvcGVydGllcy5zaXRlX3R5cGUgPT0gIlNoZWxsZmlzaCIpIHsKICAgICAgICAgICAgICBFdmVudFV0aWxzLmxvZ19ldmVudCh0aGlzLiRndGFnLCAnY2xpY2snLCAnU2hlbGxmaXNoIFN0YXRpb24nLCBmZWF0dXJlLnByb3BlcnRpZXMuZGVzY3JpcHRpb24sIDApOwogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdTaGVsbGZpc2hQYWdlJywKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICBwX3NpdGVfbmFtZTogZmVhdHVyZS5wcm9wZXJ0aWVzLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICBwX3NpdGVfaWQ6IGZlYXR1cmUuaWQsCiAgICAgICAgICAgICAgICAgIHBfcHJvZ3JhbV90eXBlOiAiU2hlbGxmaXNoIE1vbml0b3JpbmciCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB9CgogICAgICAgICAgICBlbHNlIGlmKGZlYXR1cmUucHJvcGVydGllcy5zaXRlX3R5cGUgPT0gIkJlYWNoIEFtYmFzc2Fkb3IiKSB7CiAgICAgICAgICAgICAgcmV0dXJuKEJDUlNQb3B1cCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZihmZWF0dXJlLnByb3BlcnRpZXMuc2l0ZV90eXBlID09ICJTaGVsbGNhc3QiKSB7CiAgICAgICAgICAgICAgcmV0dXJuKFNoZWxsY2FzdFBvcHVwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKGZlYXR1cmUucHJvcGVydGllcy5zaXRlX3R5cGUgPT0gIkNhbWVyYSBTaXRlIikgewogICAgICAgICAgICAgIHJldHVybihDYW1lcmFQb3B1cEJhc2ljKTsKICAgICAgICAgICAgfQoKCiAgICAgICAgICAgIC8qCiAgICAgICAgICAgIGVsc2UgaWYoZmVhdHVyZS5wcm9wZXJ0aWVzLnNpdGVfdHlwZSA9PSAiU2hlbGxmaXNoIikgewogICAgICAgICAgICAgICAgRXZlbnRVdGlscy5sb2dfZXZlbnQodGhpcy4kZ3RhZywgJ2NsaWNrJywgJ1NoZWxsZmlzaCBTdGF0aW9uJywgZmVhdHVyZS5wcm9wZXJ0aWVzLmRlc2NyaXB0aW9uLCAwKTsKICAgICAgICAgICAgICAgIHJldHVybihTaGVsbGZpc2hQb3B1cCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZihmZWF0dXJlLnByb3BlcnRpZXMuc2l0ZV90eXBlID09ICJSaXAgQ3VycmVudCIpIHsKICAgICAgICAgICAgICAgIEV2ZW50VXRpbHMubG9nX2V2ZW50KHRoaXMuJGd0YWcsICdjbGljaycsICdSaXAgQ3VycmVudCcsIGZlYXR1cmUucHJvcGVydGllcy5kZXNjcmlwdGlvbiwgMCk7CiAgICAgICAgICAgICAgICByZXR1cm4oUmlwY3VycmVudFBvcHVwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKGZlYXR1cmUucHJvcGVydGllcy5zaXRlX3R5cGUgPT0gIkNhbWVyYSBTaXRlIikgewogICAgICAgICAgICAgICAgRXZlbnRVdGlscy5sb2dfZXZlbnQodGhpcy4kZ3RhZywgJ2NsaWNrJywgJ0NhbWVyYSBTaXRlJywgZmVhdHVyZS5wcm9wZXJ0aWVzLmRlc2NyaXB0aW9uLCAwKTsKICAgICAgICAgICAgICAgIHJldHVybihDYW1lcmFQb3B1cCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgKi8KICAgICAgICAgICAgLy9yZXR1cm4oVW5rbm93blR5cGVQb3B1cCk7CiAgICAgICAgfQogICAgfSwKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgZmVhdHVyZVN0eWxpbmdDb21wbGV0ZWQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZih0aGlzLmZlYXR1cmVzLmxlbmd0aCA+IDAgJiYgKHRoaXMuZmVhdHVyZXNfc3R5bGVkID09IHRoaXMuZmVhdHVyZXMubGVuZ3RoKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygiZmVhdHVyZVN0eWxpbmdDb21wbGV0ZWQgc3R5bGVkIGFsbCBmZWF0dXJlcy4iKTsKICAgICAgICAgICAgICAgIHJldHVybih0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zb2xlLmRlYnVnKCJmZWF0dXJlU3R5bGluZ0NvbXBsZXRlZCBzdHlsZWQ6ICIgKyB0aGlzLmZlYXR1cmVzX3N0eWxlZCArICIgZmVhdHVyZXMuIik7CiAgICAgICAgICAgIHJldHVybihmYWxzZSk7CiAgICAgICAgfQogICAgfSwKICAgIHdhdGNoOiB7CgogICAgICAgIC8qCiAgICAgICAgZmVhdHVyZXM6IF8uZGVib3VuY2UoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuc2l0ZV9tYXAuJG1hcC51cGRhdGVTaXplKCk7CiAgICAgICAgICAgIHRoaXMuc2l0ZXNMYXllckV4dGVudHMgPSB0aGlzLiRyZWZzLnNpdGVfdmVjdG9yX2xheWVyLiRzb3VyY2UuZ2V0RXh0ZW50KCk7CiAgICAgICAgICAgIGxldCBtX3NpemUgPSB2bS4kcmVmcy5zaXRlX21hcC4kbWFwLmdldFNpemUoKTsKICAgICAgICAgICAgdGhpcy4kcmVmcy5zaXRlX21hcC5nZXRWaWV3KCkuZml0KHRoaXMuc2l0ZXNMYXllckV4dGVudHMsIG1fc2l6ZSk7CgogICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBgTG9hZGVkICR7dGhpcy5mZWF0dXJlcy5sZW5ndGh9YDsKCiAgICAgICAgICAgIHRoaXMuJHJlZnMubWFwVmlldy4kdmlldy5maXQoCiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmdlb2pzb25Tb3VyY2UuJHNvdXJjZS5nZXRFeHRlbnQoKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICkKICAgICAgICB9LCAxMCksKi8KICAgICAgICAvKgogICAgICAgIHNpdGVzTGF5ZXJFeHRlbnRzOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgY29uc29sZS5kZWJ1Zygic2l0ZXNMYXllckV4dGVudHMgbmV3IGV4dGVudHMiKTsKICAgICAgICB9Ki8KICAgIH0KfQo="},{"version":3,"sources":["ol_map_page.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ol_map_page.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"wrapper\">\n        <nav id=\"sidebar\" v-bind:class=\"[sidebarActive ? 'active' : '']\">\n            <div class=\"h-100 px-5 py-4 montserat-font text-center text-white blue-background_color sidebar-opacity\">\n                <a href=\"/\">\n                    <h6><i><span v-text=\"title\"></span></i></h6>\n                </a>\n                <h4><span v-text=\"site_name\"></span></h4>\n                <p class=\"text-left\">\n                    Bacteria levels can change rapidly between sampling dates. To fill in the gaps,\n                    we make daily <b>Nowcast</b> of bacteria conditions. These predictions do not represent\n                    swimming advisories, but provide estimates of the likelihood that bacteria conditions\n                    would warrant issuing an advisory if sampling were conducted that day.\n                </p>\n                <b-button class=\"btn-outline-primary p-2 mr-2\" v-bind:class=\"[nowcastActive ? 'active' : '']\"\n                          variant=\"outline-primary\"\n                          v-on:click=\"dataTypeClick('nowcast')\"><b>Nowcast</b></b-button>\n                <b-button class=\"btn-outline-primary p-2 ml-2\" v-bind:class=\"[advisoryActive ? 'active' : '']\"\n                          variant=\"outline-primary\"\n                          v-on:click=\"dataTypeClick('advisory')\"><b>Advisory</b></b-button>\n\n                <b-dropdown id=\"layer_dropdown\" class=\"layer_dropdown mt-4\" :text=\"current_layer_name\">\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'openstreetmap', '')\">Open Street Map</b-dropdown-item>\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 'm')\">Road</b-dropdown-item>\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 's')\">Satellite</b-dropdown-item>\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 'y')\">Hybrid Satellite</b-dropdown-item>\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 'p')\">Hybrid Terrain</b-dropdown-item>\n                    <!--\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 'r')\">Altered Road</b-dropdown-item>\n                    <b-dropdown-item class=\"dropdown-item\" @click=\"layerSelected($event, 'google', 't')\">Terrain</b-dropdown-item>\n                    -->\n                </b-dropdown>\n                <br>\n                <p class=\"text-center mt-4\">\n                    <a href=\"\" class=\"text-white card-link\">Bacteria Sources</a>\n                </p>\n                <p class=\"text-center\">\n                    <a href=\"#\" class=\"text-white card-link\">Locations</a>\n                </p>\n                <p class=\"text-center\">\n                    <a href=\"/About\" class=\"text-white card-link\">About</a>\n                </p>\n            </div>\n        </nav>\n        <div id=\"content\">\n            <vl-map id=\"site_map\"\n                    style=\"width: 100%; height: 100%; position:absolute\"\n                    ref=\"site_map\"\n                    :load-tiles-while-animating=\"true\"\n                    :load-tiles-while-interacting=\"true\"\n                    data-projection=\"EPSG:4326\">\n                <vl-view :center.sync=\"center\" :rotation.sync=\"rotation\"></vl-view>\n                <vl-layer-tile :visible=\"xyz_layer_visible\">\n                    <vl-source-xyz :url=\"current_layer_url\" attributions=\"string or array\" />\n                </vl-layer-tile>\n                <vl-layer-tile :visible=\"osm_layer_visible\">\n                    <vl-source-osm></vl-source-osm>\n                </vl-layer-tile>\n\n                <vl-layer-vector id=\"sites\">\n                    <vl-source-vector ref=\"site_vector_layer\" :features.sync=\"features\"></vl-source-vector>\n                    <vl-style-func :factory=\"siteStyleFactory\"></vl-style-func>\n                </vl-layer-vector>\n                <vl-interaction-select :features.sync=\"selectedFeatures\" :layers=\"['sites']\">\n                    <vl-overlay v-for=\"feature in selectedFeatures\"\n                                :key=\"feature.id\"\n                                :id=\"feature.id\"\n                                :position=\"feature.geometry.coordinates\"\n                                :auto-pan=\"true\"\n                                :auto-pan-animation=\"{ duration: 300 }\">\n                        <div>\n                            <div :is=\"getPopupComponent(feature)\" v-bind:feature=\"feature\"></div>\n                            <!---\n                            <component :is=\"getPopupComponent(feature)\" v-bind:feature=\"feature\"></component>\n                            --->\n\n                        </div>\n                    </vl-overlay>\n\n                </vl-interaction-select>\n            </vl-map>\n            <button\n                    v-b-toggle.info-sidebar\n                    id=\"sidebarCollapse\"\n                    class=\"btn btn-outline-info btn-sm\"\n                    v-on:click=\"sidebarButtonClick()\"\n                    v-bind:class=\"[sidebarBtnActive ? 'active' : '']\">\n                <span></span>\n                <span></span>\n                <span></span>\n            </button>\n\n        </div>\n\n        <div v-show=\"featureStylingCompleted\">\n            <IconsLegend :icon_info=\"legend_icons\"></IconsLegend>\n        </div>\n\n        <!-- This gives us the ability to know when the media queries/breaks occur -->\n        <span ref=\"mq_detector\" id=\"mq-detector\">\n            <span ref=\"visible_xs\" class=\"d-block d-sm-none\">\n            </span>\n            <span ref=\"visible_sm\" class=\"d-none d-sm-block d-md-none\">\n            </span>\n            <span ref=\"visible_md\" class=\"d-none d-md-block d-lg-none\">\n            </span>\n            <span ref=\"visible_lg\" class=\"d-none d-lg-block d-xl-none\">\n            </span>\n            <span ref=\"visible_xlg\" class=\"d-none d-xl-block\">\n            </span>\n        </span>\n    </div>\n</template>\n\n<script>\n    import Vue from 'vue'\n    import 'bootstrap/dist/css/bootstrap.min.css'\n    import 'bootstrap-vue/dist/bootstrap-vue.css'\n    import 'typeface-montserrat/index.css'\n\n    import { Map, TileLayer, OsmSource, Geoloc, VectorLayer, VectorSource, XyzSource, StyleBox, CircleStyle, FillStyle,\n        StrokeStyle, Overlay, SelectInteraction, StyleFunc } from 'vuelayers'\n    Vue.use(Map);\n    Vue.use(TileLayer);\n    Vue.use(OsmSource);\n    Vue.use(Geoloc);\n    Vue.use(VectorLayer);\n    Vue.use(VectorSource);\n    Vue.use(XyzSource);\n    Vue.use(StyleBox);\n    Vue.use(FillStyle);\n    Vue.use(StrokeStyle);\n    Vue.use(CircleStyle);\n    Vue.use(Overlay);\n    Vue.use(SelectInteraction);\n    Vue.use(StyleFunc);\n\n\n    import 'vuelayers/lib/style.css' // needs css-loader\n\n    import { SidebarPlugin, ButtonPlugin, ButtonGroupPlugin, LayoutPlugin } from 'bootstrap-vue';\n    Vue.use(ButtonPlugin);\n    Vue.use(ButtonGroupPlugin);\n    Vue.use(LayoutPlugin);\n    Vue.use(SidebarPlugin);\n\n    import DataAPI from \"../utilities/rest_api\";\n    import FeatureUtils from \"../utilities/feature_funcs\";\n    import {findPointOnSurface} from 'vuelayers/lib/ol-ext'\n    import EventUtils from \"../utilities/analytics_funcs\";\n\n    import IconsLegend from \"@/components/icons_legend\";\n\n    import Style from 'ol/style/Style';\n    import Icon from 'ol/style/Icon';\n\n    //SInce these are not in the template, we import them here. We use them in the javascript below when\n    //determining which icon to use.\n    import LowMarkerIcon from '@/assets/images/low_marker_25x25.png'\n    import HiMarkerIcon from '@/assets/images/high_marker_25x25.png'\n    import NoneMarkerIcon from '@/assets/images/none_marker_25x25.png'\n\n    export default {\n        name: 'OLMapPage',\n\n        components: {\n          IconsLegend\n        },\n        data () {\n            return {\n                title: \"HOW'S THE BEACH\",\n                site_name: \"\",\n                zoom: 5,\n                center: [0,0],\n                rotation: 0,\n                features: [],\n                loading: false,\n                current_google_layer: 's',\n                current_layer_url: '',\n                current_layer_name: \"Satellite\",\n                xyz_layer_visible: true,\n                osm_layer_visible: false,\n                selectedFeatures: [],\n                advisory_limits: undefined,\n                nowcastActive: true,\n                advisoryActive: false,\n                sidebarActive: false,\n                sidebarBtnActive: false,\n                currMqNdx: undefined,\n                mqSelectors: undefined,\n                legend_icons: [],\n                features_styled: 0\n            }\n        },\n        created() {\n\n            window.addEventListener(\"resize\", this.resizeHandler);\n        },\n        mounted () {\n            let vm = this;\n            this.loading = true;\n            this.features_styled = 0;\n\n            this.mqSelectors = [\n                this.$refs.visible_xs,\n                this.$refs.visible_sm,\n                this.$refs.visible_md,\n                this.$refs.visible_lg,\n                this.$refs.visible_xlg\n            ];\n\n\n            this.current_layer_url = `https://mt0.google.com/vt/lyrs=${this.current_google_layer}&hl=en&x={x}&y={y}&z={z}`;\n            let path = window.location.pathname;\n            if (path.length) {\n                let location_site_name = this.$store.state.site_name;\n                console.debug(\"Retrieving initial site: \" +  location_site_name + \" data.\");\n                DataAPI.GetSitesPromise(location_site_name, '', true, true).then(features => {\n                    console.debug(\"Retrieved: \" + features.data.sites.features.length + \" features\");\n                    vm.features = features.data.sites.features;\n                    if('limits' in features.data.advisory_info) {\n                        this.$store.commit('updateAdvisoryLimits', features.data.advisory_info.limits);\n                    }\n                    this.site_name = features.data.project_area.name;\n\n                    vm.loading =  false;\n\n                    setTimeout(function() {\n                        if(vm.$refs.site_vector_layer.$source != undefined) {\n                            vm.$refs.site_map.$map.updateSize();\n                            vm.sitesLayerExtents = vm.$refs.site_vector_layer.$source.getExtent(vm.sitesLayerExtents);\n                            let m_size = vm.$refs.site_map.$map.getSize();\n                            vm.$refs.site_map.getView().fit(vm.sitesLayerExtents, m_size);\n                            //vm.$refs.site_map.$map.redraw();\n                        }\n                    }, 100);\n                    /*\n                    vm.$nextTick(function() {\n                        console.debug(\"nextTick mounted setting map extent.\");\n                    });*/\n                })\n                    .catch(error => {\n                        let error_message = '';\n                        let status_code = 404;\n                        if('response' in error && error.response !== undefined) {\n                            status_code = error.response.status;\n                            if ('error' in error.response.data) {\n                                if ('message' in error.response.data.error) {\n                                    error_message = error.response.data.error.message;\n                                }\n                            } else {\n                                error_message = error.response.data;\n                            }\n                            console.error(\"Status code: \" + status_code +\". Error Msg: \" + error_message);\n                        }\n                        else{\n                            console.error(error);\n                            error_message = error;\n                        }\n                        this.$router.push({\n                            name: '404',\n                            params: {\n                                error_message: error_message,\n                                status_code: status_code\n                            }\n                        });\n                    });\n\n            }\n        },\n        destroyed() {\n            window.removeEventListener(\"resize\", this.resizeHandler);\n        },\n        methods: {\n            resizeHandler() {\n\n                for (var i = 0; i < this.mqSelectors.length; i++) {\n                    if(this.mqSelectors[i].offsetLeft > 0)\n                    {\n                        if (this.currMqIdx != i) {\n                            this.currMqIdx = i;\n                            break;\n                        }\n                    }\n                }\n                if(this.currMqIdx < 3)\n                {\n                    this.sidebarActive = false;\n                }\n\n            },\n            pointOnSurface: findPointOnSurface,\n            siteStyleFactory() {\n                console.debug(\"siteStyleFactory started\");\n                let vm = this;\n                /*\n                For each feature, this function is used to determine what icon to use based on the level.\n                */\n                var siteStyleFunction = function(feature, resolution) {\n                    resolution;\n                    if(vm.features_styled < vm.features.length) {\n                        vm.features_styled += 1;\n                    }\n                    let icon_scale = 0.75;\n                    let properties = feature.getProperties();\n                    let site_type = properties.site_type;\n                    let icon = new Icon({\n                        src: NoneMarkerIcon,\n                        scale: icon_scale\n                    });\n                    if(site_type == 'Water Quality')\n                    {\n                        try\n                        {\n                            if (vm.advisoryActive) {\n                              if ('advisory' in properties[site_type]) {\n                                let dataFresh = FeatureUtils.isDataFresh(properties[site_type].advisory);\n                                if (dataFresh) {\n                                  let value = properties[site_type].advisory.value;\n                                  let hi_limit = vm.$store.state.advisory_limits.hi;\n                                  let lo_limit = vm.$store.state.advisory_limits.low;\n                                  if (value >= hi_limit.minimum) {\n                                    //console.debug(\"Feature: \" + feature.getId() + \" Hi style value: \" + value);\n                                    icon = new Icon({\n                                      src: HiMarkerIcon,\n                                      scale: icon_scale\n                                    });\n                                  } else if (value < lo_limit.maximum) {\n                                    //console.debug(\"Feature: \" + feature.getId() + \" Low style value: \" + value);\n                                    icon = new Icon({\n                                      src: LowMarkerIcon,\n                                      scale: icon_scale\n                                    });\n                                  }\n                                }\n                              } else {\n                                console.debug(\"Feature: \" + feature.getId() + \" No advisory data found.\");\n                              }\n                            } else {\n                              icon = new Icon({\n                                src: NoneMarkerIcon,\n                                scale: icon_scale\n                              });\n                              if ('nowcasts' in properties[site_type]) {\n                                let level = properties[site_type].nowcasts.level;\n                                if (level == 'LOW') {\n                                  icon = new Icon({\n                                    src: LowMarkerIcon,\n                                    scale: icon_scale\n                                  });\n                                } else if (level == 'HIGH') {\n                                  icon = new Icon({\n                                    src: HiMarkerIcon,\n                                    scale: icon_scale\n                                  });\n                                }\n                              }\n                            }\n                        }\n                        catch(error)\n                        {\n                          icon = new Icon({\n                            src: NoneMarkerIcon,\n                            scale: icon_scale\n                          });\n\n                          console.error(error);\n                        }\n                        if (!(vm.legend_icons.includes('Water Quality'))) {\n                          vm.legend_icons.push(\"Water Quality\");\n                        }\n                    }\n                    else if(site_type == 'Shellfish')\n                    {\n                        try\n                        {\n                            if (site_type in properties) {\n                              //First check to see if our data is still fresh.\n                              let dataFresh = FeatureUtils.isDataFresh(properties[site_type].advisory);\n                              if (dataFresh) {\n                                //Shellfish values are either true for closed or false for open.\n                                let value = properties[site_type].advisory.value;\n                                if (!value) {\n                                  icon = new Icon({\n                                    src: ShellfishLowMarkerIcon,\n                                    scale: icon_scale\n                                  });\n                                } else {\n                                  icon = new Icon({\n                                    src: ShellfishHiMarkerIcon,\n                                    scale: icon_scale\n                                  });\n                                }\n                              } else {\n                                icon = new Icon({\n                                  src: ShellfishNoneMarkerIcon,\n                                  scale: icon_scale\n                                });\n                              }\n                            }\n                        }\n                        catch(error)\n                        {\n                            icon = new Icon({\n                              src: ShellfishNoneMarkerIcon,\n                              scale: icon_scale\n                            });\n                            console.error(error);\n                        }\n                        if (!(vm.legend_icons.includes('Shellfish'))) {\n                          vm.legend_icons.push(\"Shellfish\");\n                        }\n                    }\n                    else if(site_type == 'Camera Site') {\n                        icon = new Icon({\n                            src: CameraIcon,\n                            scale: icon_scale\n                        });\n                        if(!(vm.legend_icons.includes('Camera Site'))) {\n                            vm.legend_icons.push('Camera Site');\n                        }\n\n                    }\n\n                    else if(site_type == 'Beach Ambassador') {\n                      icon = new Icon({\n                        src: MoteMarineBeachAmbassadorIcon,\n                        //Scale the icon a bit to make it less overwhelming on the map.\n                        scale: 0.8\n                      });\n                      if(!(vm.legend_icons.includes('Beach Ambassador'))) {\n                        vm.legend_icons.push('Beach Ambassador');\n                      }\n\n                    }\n\n                    else if(site_type == 'Shellcast')\n                    {\n                      icon = new Icon({\n                        src: ShellcastIcon,\n                      });\n                      if(!(vm.legend_icons.includes('Shellcast'))) {\n                        vm.legend_icons.push('Shellcast');\n                      }\n\n                    }\n\n                  let icon_style = [\n                        new Style({\n                            image: icon,\n                        })\n                    ];\n                    return(icon_style);\n                };\n                return siteStyleFunction;\n            },\n            dataTypeClick(data_type) {\n                console.debug(\"Data Type Button clicked: \" + data_type);\n                if(data_type == 'nowcast')\n                {\n                    this.nowcastActive = true;\n                    this.advisoryActive = false;\n                    this.$refs.site_vector_layer.$source.changed();\n                }\n                else{\n                    this.nowcastActive = false;\n                    this.advisoryActive = true;\n                    this.$refs.site_vector_layer.$source.changed();\n                }\n            },\n            sidebarButtonClick() {\n                this.sidebarActive = !this.sidebarActive;\n                this.sidebarBtnActive = !this.sidebarBtnActive;\n                console.debug(\"sidebarButtonClick clicked: \" + this.sidebarActive);\n            },\n            layerSelected(event, layer_type, layer_selected) {\n                //Set the name of the current layer selected in dropdown.\n                this.current_layer_name = event.target.text;\n                this.osm_layer_visible = false;\n                this.xyz_layer_visible = false;\n                if(layer_type === 'google') {\n                    this.xyz_layer_visible = true;\n                    //Build the URL for the XYZ google layer.\n                    this.current_google_layer = layer_selected;\n                    this.current_layer_url = `https://mt0.google.com/vt/lyrs=${this.current_google_layer}&hl=en&x={x}&y={y}&z={z}`;\n                }\n                else if(layer_type == 'openstreetmap') {\n                    this.osm_layer_visible = true;\n                }\n            },\n            /*\n            This allows us to dynamically choose the popup to use based on the site_type field.\n            */\n            getPopupComponent(feature) {\n                /*Track the click event*/\n                /*this.$ga.event({\n                    eventCategory: 'SampleSiteClick',\n                    eventAction: 'click',\n                    eventLabel: feature.properties.description\n                });*/\n\n                if(feature.properties.site_type == \"Water Quality\")\n                {\n                    let name = 'StationPage';\n                    EventUtils.log_event(this.$gtag, 'click', 'WQ Station', feature.properties.description, 0);\n                    this.$router.push({\n                      name: name,\n                      params: {\n                        site_name: feature.properties.description,\n                        site_id: feature.id,\n                        graph_data: this.graph_data\n                      }\n                    });\n\n                  //return(WQPopup);\n                }\n\n                else if(feature.properties.site_type == \"Shellfish\") {\n                  EventUtils.log_event(this.$gtag, 'click', 'Shellfish Station', feature.properties.description, 0);\n                  this.$router.push({\n                    name: 'ShellfishPage',\n                    params: {\n                      p_site_name: feature.properties.description,\n                      p_site_id: feature.id,\n                      p_program_type: \"Shellfish Monitoring\"\n                    }\n                  });\n\n                }\n\n                else if(feature.properties.site_type == \"Beach Ambassador\") {\n                  return(BCRSPopup);\n                }\n                else if(feature.properties.site_type == \"Shellcast\") {\n                  return(ShellcastPopup);\n                }\n                else if(feature.properties.site_type == \"Camera Site\") {\n                  return(CameraPopupBasic);\n                }\n\n\n                /*\n                else if(feature.properties.site_type == \"Shellfish\") {\n                    EventUtils.log_event(this.$gtag, 'click', 'Shellfish Station', feature.properties.description, 0);\n                    return(ShellfishPopup);\n                }\n                else if(feature.properties.site_type == \"Rip Current\") {\n                    EventUtils.log_event(this.$gtag, 'click', 'Rip Current', feature.properties.description, 0);\n                    return(RipcurrentPopup);\n                }\n                else if(feature.properties.site_type == \"Camera Site\") {\n                    EventUtils.log_event(this.$gtag, 'click', 'Camera Site', feature.properties.description, 0);\n                    return(CameraPopup);\n                }\n                */\n                //return(UnknownTypePopup);\n            }\n        },\n        computed: {\n            featureStylingCompleted: function() {\n                if(this.features.length > 0 && (this.features_styled == this.features.length))\n                {\n                    console.debug(\"featureStylingCompleted styled all features.\");\n                    return(true);\n                }\n                console.debug(\"featureStylingCompleted styled: \" + this.features_styled + \" features.\");\n                return(false);\n            }\n        },\n        watch: {\n\n            /*\n            features: _.debounce(function() {\n                this.$refs.site_map.$map.updateSize();\n                this.sitesLayerExtents = this.$refs.site_vector_layer.$source.getExtent();\n                let m_size = vm.$refs.site_map.$map.getSize();\n                this.$refs.site_map.getView().fit(this.sitesLayerExtents, m_size);\n\n                this.message = `Loaded ${this.features.length}`;\n\n                this.$refs.mapView.$view.fit(\n                    this.$refs.geojsonSource.$source.getExtent(),\n                    {\n                        duration: 1000,\n                    },\n                )\n            }, 10),*/\n            /*\n            sitesLayerExtents: function() {\n                console.debug(\"sitesLayerExtents new extents\");\n            }*/\n        }\n    }\n</script>\n<style>\n    body, html {\n        height: 100%;\n    }\n    .btn-outline-primary {\n\n        color: #FFFFFF;\n        border-color: #FFFFFF;\n        opacity: 0.75;\n    }\n    .btn-outline-primary:hover,\n    .btn-outline-primary:focus,\n    .btn-outline-primary:active {\n        color: rgba(0, 61, 126, .85);\n        background-color: #ffffff;\n        border-color: #FFFFFF;\n        opacity: 0.75;\n    }\n    .btn-outline-primary:not(:disabled):not(.disabled).active,\n    .btn-outline-primary:not(:disabled):not(.disabled):active,\n    .show > .btn-outline-primary.dropdown-toggle\n    {\n        color: rgba(0, 61, 126, .85);\n        background-color: #ffffff;\n        border-color: #FFFFFF;\n        opacity: 0.75;\n\n    }\n    #vl-map-site_map .ol-zoom {\n        background-color: rgba(0, 61, 126, .85) !important;\n    }\n    #vl-map-site_map .ol-zoom-out {\n        background-color: rgba(0, 61, 126, .85) !important;\n    }\n    /*\n    #vl-map-site_map .ol-zoom-in {\n        margin-top: 200px !important;\n    }\n    #vl-map-site_map .ol-zoom-out {\n        margin-top: 240px !important;\n    }\n    */\n    .layer_dropdown > button {\n        background-color: rgba(0, 61, 126, .85);\n        border-color: #FFFFFF;\n        opacity: 0.75;\n    }\n\n    .layer_dropdown > .btn-secondary:hover,\n    .layer_dropdown > .btn-secondary:focus,\n    .layer_dropdown > .btn-secondary:active {\n        color: rgba(0, 61, 126, .85);\n        background-color: #FFFFFF;\n        opacity: 0.75;\n    }\n\n</style>\n<style scoped>\n    .wrapper {\n        display: flex;\n        width: 100%;\n        height: 100%;\n        align-items: stretch;\n        perspective: 1500px;\n    }\n\n    #sidebar {\n        min-width: 300px;\n        max-width: 300px;\n        background: #7386D5;\n        color: #fff;\n        transition: all 0.6s cubic-bezier(0.945, 0.020, 0.270, 0.665);\n        transform-origin: bottom left;\n    }\n\n    #sidebar.active {\n        margin-left: -300px;\n        transform: rotateY(100deg);\n    }\n\n    #sidebar .sidebar-header {\n        padding: 20px;\n        background: #6d7fcc;\n    }\n\n    #sidebar ul.components {\n        padding: 20px 0;\n        border-bottom: 1px solid #47748b;\n    }\n\n    #sidebar ul p {\n        color: #fff;\n        padding: 10px;\n    }\n\n    #sidebar ul li a {\n        padding: 10px;\n        font-size: 1.1em;\n        display: block;\n    }\n    #sidebar ul li a:hover {\n        color: #7386D5;\n        background: #fff;\n    }\n\n    #sidebar ul li.active > a, a[aria-expanded=\"true\"] {\n        color: #fff;\n        background: #6d7fcc;\n    }\n\n    #sidebarCollapse {\n        width: 40px;\n        height: 40px;\n        background: #f5f5f5;\n    }\n\n    #sidebarCollapse span {\n        width: 80%;\n        height: 2px;\n        margin: 0 auto;\n        display: block;\n        background: #555;\n        transition: all 0.8s cubic-bezier(0.810, -0.330, 0.345, 1.375);\n    }\n    #sidebarCollapse span:first-of-type {\n        /* rotate first one */\n        transform: rotate(45deg) translate(2px, 2px);\n    }\n    #sidebarCollapse span:nth-of-type(2) {\n        /* second one is not visible */\n        opacity: 0;\n    }\n    #sidebarCollapse span:last-of-type {\n        /* rotate third one */\n        transform: rotate(-45deg) translate(1px, -1px);\n    }\n    #sidebarCollapse.active span {\n        /* no rotation */\n        transform: none;\n        /* all bars are visible */\n        opacity: 1;\n        margin: 5px auto;\n    }\n    #sidebarCollapse {\n        position: relative;\n        z-index: 1000;\n        top: 7em;\n        left: .75em;\n    }\n    #content {\n        width: 100%;\n        min-height: 100vh;\n        transition: all 0.3s;\n    }\n\n    .sidebar-opacity {\n        opacity: 0.9;\n    }\n    @media (max-width: 768px) {\n        #sidebar {\n            margin-left: -300px;\n        }\n        #sidebar.active {\n            margin-left: 0;\n        }\n        #sidebar.active {\n            margin-left: 0;\n            transform: none;\n        }\n        #sidebarCollapse span:first-of-type,\n        #sidebarCollapse span:nth-of-type(2),\n        #sidebarCollapse span:last-of-type {\n            transform: none;\n            opacity: 1;\n            margin: 5px auto;\n        }\n        #sidebarCollapse.active span {\n            margin: 0 auto;\n        }\n        #sidebarCollapse.active span:first-of-type {\n            transform: rotate(45deg) translate(2px, 2px);\n        }\n        #sidebarCollapse.active span:nth-of-type(2) {\n            opacity: 0;\n        }\n        #sidebarCollapse.active span:last-of-type {\n            transform: rotate(-45deg) translate(1px, -1px);\n        }\n        /*#sidebarCollapse span {\n            display: none;\n        }*/\n    }\n    #mq-detector {\n        visibility: hidden;\n    }\n</style>\n"]}]}